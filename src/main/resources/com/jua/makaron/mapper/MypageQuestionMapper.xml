<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jua.makaron.mapper.MypageQuestionMapper">

	<!-- 1. 상품 문의 내역 불러오기 -->
	<select id="getQuestionList" resultType="com.jua.makaron.vo.ReviewVO">
		<![CDATA[
			SELECT 
			    pq.no AS no,
			    customer_id,
			    c.name AS customer_name,
			    p.title AS product_name,
			    pq.title AS qna_title,
			    pq.content AS qna_content,
			    pq.update_date AS qna_update_date
			FROM 
			    product_qna pq, product p, customer c
			WHERE
			    p.id = pq.product_id
			    AND c.id = pq.customer_id
			    AND customer_id = #{id}
			    AND pq.is_del = 'N'
		]]>
	</select>
	
	
	<!-- 2. 상품 문의 등록 -->
	<insert id="insertQuestion">
		<![CDATA[
			INSERT INTO 
			    product_qna
			VALUES
			    (
			    SEQ_PRODUCT_QNA.nextval, 
			    (
			    SELECT 
			    	id 
			    FROM 
			    	product 
			    WHERE 
			    	title= #{product_title}
			    ), 
			   	#{id}, 
			    #{qna_title}, 
			    #{qna_content}, 
			    sysdate, 
			    sysdate,
			    'N'
			    )
		]]>
	</insert>
	
	
	<!-- 3. 상품 문의 삭제 -->
	<update id="deleteQuestion">
		<![CDATA[
			UPDATE s
			    product_qna
			SET 
			    is_del = 'Y'
			WHERE
			    no = #{no}
		]]>
	</update>
	
</mapper>