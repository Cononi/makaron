<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jua.makaron.mapper.MypageQuestionMapper">

	<!-- 1. 상품 문의 내역 불러오기 -->
	<select id="getQuestionList" resultType="com.jua.makaron.vo.ProductQnaVO">
		<![CDATA[
			SELECT
			    pq.qna_no,
			    customer_id,
			    c.name,
			    p.product_title,
			    pq.qna_title,
			    pq.qna_content,
			    pq.update_date 
			FROM
			    product_qna pq,
			    product p,
			    customer c
			WHERE
			    pq.product_id = p.product_id
			    AND pq.customer_id = c.id
			    AND customer_id = #{id}
			    And pq.is_del = 'N';
		]]>
	</select>
	
	
	<!-- 2. 상품 문의 등록 -->
	<insert id="insertQuestion">
		<![CDATA[
			INSERT INTO 
			    product_qna
			VALUES
			    (
			    SEQ_PRODUCT_QNA.nextval, 
			    (
			    SELECT 
			    	product_id
			    FROM 
			    	product 
			    WHERE 
			    	product_title= #{product_title}
			    ), 
			   	#{id}, 
			    #{qna_title}, 
			    #{qna_content}, 
			    sysdate, 
			    sysdate,
			    'N'
			    )
		]]>
	</insert>
	
	
	<!-- 3. 상품 문의 삭제 -->
	<update id="deleteQuestion">
		<![CDATA[
			UPDATE
			    product_qna
			SET 
			    is_del = 'Y'
			WHERE
			    qna_no = #{qna_no}
		]]>
	</update>
	
</mapper>